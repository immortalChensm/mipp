<include file="Public/min-header" />
<style>
.add_tag{display:none;margin-left:10px;}
</style>
<div class="wrapper">
    <include file="Public/breadcrumb"/>
	<section class="content">
       <div class="row">
       		<div class="col-xs-12">
	       		<div class="box">
	             <div class="box-header">
	             	<!-- 导航菜单 -->
	             	<if condition="$admin_info.type eq 1">
					<include file="Course/nav" act_nav="course_tag"/>
					</if>
	               	<nav class="navbar navbar-default">	     
				        <div class="collapse navbar-collapse">
				          <form class="navbar-form form-inline" action="{:U('Course/course_tag')}" method="get">
				            <div class="form-group">
				              	<input type="text" name="keywords" class="form-control" placeholder="标签名称" value="{:I('keywords')}">
				            </div>
				            <button type="submit" class="btn btn-default">提交</button>
				            <div class="form-group pull-right">
					            <a id="add_btn" href="javascript:void(0)" onclick="add_tag(this)" class="btn btn-primary pull-right"><i class="fa fa-plus"></i>添加标签</a>
					            <input id="tag_input" style="display:none;" name="name" class="form-control" placeholder="请输入标签名称" value="{:I('keywords')}">
					            <a href="javascript:void(0)" onclick="cancel_save()" class="btn btn-default pull-right add_tag">取消</a>
					            <a href="javascript:void(0)" onclick="save_tag('',$('#tag_input').val())" class="btn btn-primary pull-right add_tag">保存</a>
				            </div>
				          </form>
				      	</div>
	    			</nav>
	             </div>
	             <div class="box-body">
	           		<div class="row">
	            	<div class="col-sm-12">
		              <table id="list-table" class="table table-bordered table-striped dataTable">
		                 <thead>
		                   <tr role="row">
			                   <th width="10%">ID</th>
			                   <th width="30%">标签名称</th>
			                   <th width="30%">添加时间</th>
			                   <th width="30%">操作</th>
		                   </tr>
		                 </thead>
						<tbody>
						  <foreach name="list" item="vo" key="k" >
						  	<tr role="row" align="center">
		                     <td>{$vo.id}</td>
                             <td><input type="text" value="{$vo.name}" onblur="change_name('{$vo.id}',this.value)"/></td>
                             <td>{$vo.create_date}</td>
		                     <td>
			                     <a title="删除" class="btn btn-danger" href="javascript:void(0)" data-id="{$vo.id}" onclick="dele_course_tag('{$vo.id}')"><i class="fa fa-trash-o"></i></a>
							 </td>
		                   </tr>
		                  </foreach>
		                   </tbody>
		                 <tfoot>                 
		                 </tfoot>
		               </table>
	               </div>
	          </div>
              <div class="row">
              	    <div class="col-sm-6 text-left"></div>
                    <div class="col-sm-6 text-right">{$page}</div>		
              </div>
	         </div>
	        </div>
       	</div>
       </div>
   </section>
</div>
<script src="__PUBLIC__/js/ajaxfileupload.js" type="text/javascript"></script>
<include file="Public/dialog"/>
<script>
function add_tag(){
	$('#add_btn').hide();
	$('.add_tag').show();
	$('#tag_input').show().focus();
}
function cancel_save(){
	$('.add_tag').hide();
	$('#add_btn').show();
	$('#tag_input').hide();
}

function change_name(id,name){
	$.post("{:U('Course/edit_course_tag')}",{info:{id:id,name:$.trim(name)},act:'save'},function(res){
		if(res.status == '1') location.reload();
	});
}
function save_tag(id,name){
	$.post("{:U('Course/edit_course_tag')}",{info:{id:id,name:$.trim(name)},act:'save'},function(res){
		if(res.status == '1'){
			jsalert(res.info,1,function(){
				location.reload();
			});
		}else{
			jsalert(res.info,2);
		}
	});
}

function dele_course_tag(id){
	jsconfirm('确认要删除吗？',function(){
		$.ajax({
			type : 'post',
			url : '{:U("Course/dele_course_tag")}',
			data : {id:id},
			dataType : 'json',
			success : function(data){
				if(data.status == '1'){
					jsalert(data.info,1,function(){
						location.reload();
					});
				}else{
					jsalert(data.info,2);
				}
			}
		})
	});
	return false;
}

</script> 
</body>
</html>